<html>
  <head>
    <meta charset="utf-8">
    <title>Chatting</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body {
        font: 12px 'Lucida Grande', Helvetica, Arial, sans-serif;
        }
        .Chatbackground {
        background-color: #b4aec2;
        padding: 15px;
        width: 250px;
        }

        .talk {
        position: relative;
        padding: 15px;
        margin: 1em 0 1em;
        color: black;
        -webkit-border-radius: 10px;
        -moz-border-radius: 10px;
        border-radius: 10px;
        width: auto;
        }
        .talk.me {
        margin-left: 30px;
        border: 5px solid #fff;
        background: #fff;
        }
        .talk.other {
        margin-right: 30px;
        border: 5px solid rgb(238, 213, 99);
        background-color: rgb(238, 213, 99);
        }
        .talk.name {
        margin-right: 30px;
        font-size: 8px;
        padding: 0px;
        margin: 0px;
        }
        .msg {
        display: inline-block;
        height: 34px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857;
        color: #555555;
        background-color: #fff;
        background-image: none;
        border: 0px solid #ccc;
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
        }
        .send {
        background-color: #fff;
        display: inline-block;
        margin-bottom: 0;
        font-weight: normal;
        text-align: center;
        vertical-align: middle;
        border: 0px solid transparent;
        height: 46px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857;
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
        }

        .msgbox {
        width: auto;
        height: 300px;
        overflow: auto;
        }

        .msgbox::-webkit-scrollbar {
        width: 10px;
        }

        .msgbox::-webkit-scrollbar-thumb {
        background-color: #cfe2f5;
        border-radius: 10px;
        background-clip: padding-box;
        border: 2px solid transparent;
        }

        .msgbox::-webkit-scrollbar-track {
        background-color: #c1aeee;
        border-radius: 10px;
        box-shadow: inset 0px 0px 5px white;

        }
        #nickName{
            height: 10px;
            padding: 2px 2px 2px 2px; 
            size: 9;
            font-size: 8pt; 
        }
    </style>
 
  <script>
    $(function(){
      //let socket = io();
      
      let socket = io('http://localhost:3000');
      let br = document.createElement("br");

      socket.on('Mmessage', msg => {   //자기 메세지 
        $('#messages').append($('<p class="talk me">').text(msg));
        var objDiv = document.getElementById("messages"); 
        objDiv.scrollTop = objDiv.scrollHeight;  //스크롤 최하단 포커스
      });

      socket.on('Omessage', (name, msg) => {   //다른사람 메세지 
        var tempstr = name + msg;
        $('#messages').append($('<p class="talk name">').text(name));
        $('#messages').append($('<p class="talk other">').text(msg));
        var objDiv = document.getElementById("messages"); 
        objDiv.scrollTop = objDiv.scrollHeight;       //스크롤 최하단 포커스
      });
  
      $("#msinput").keyup(function(key){
        if(key.keyCode==13){    // 엔터 눌렀을 때
            socket.emit('message', $("#nickName").val(),$("#msinput").val());
          $("#msinput").val('');
        }
      });

      $("#btns").on('click', function(){   // 전송 버튼 눌렀을 때
        //   msg.name = $("#nickName").val();
        //   msg.msg = $("#msinput").val();
          socket.emit('message', $("#nickName").val(),$("#msinput").val());
          $("#msinput").val('');
          
      });
      socket.on('create name', function(name){ 
      $('#nickName').val(name);
      });

    })
  </script>
  </head>
  <body>
    <div class="Chatbackground" >
      <div class ="msgbox" id="messages"></div>
      <input id="nickName" class="msg" type="text" class="nick"/>
      <input id="msinput" class="msg" type="text"/>
      <button id="btns" class="send" type="button">전송</button>
    </div>
  </body>
